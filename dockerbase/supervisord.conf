[supervisord]
user=root
logfile=/tmp/supervisord.log
logfile_maxbytes=50MB
logfile_backups=10
loglevel=info
pidfile=/tmp/supervisord.pid
; nodaemon=false
nodaemon=true

minfds=1024
minprocs=200

[rpcinterface:supervisor]
supervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface

[supervisorctl]
serverurl=unix:///tmp/supervisor.sock

[program:django]
; command=python manage.py runserver 0.0.0.0:8000
command=python manage.py migrate && python manage.py runserver 0.0.0.0:8000
 directory=/app/core
user=root
autostart=true
autorestart=true
redirect_stderr=true
; stdout_logfile=/tmp/django.log
stdout_logfile_maxbytes=10MB
stdout_logfile_backups=3

# Django 日志：同时输出到文件和控制台
stdout_logfile=/var/log/django_stdout.log  # 标准输出日志文件
stdout_logfile_maxbytes=50MB
stdout_logfile_backups=3
stdout_logfile=/dev/stdout                 # 同时输出到控制台
redirect_stderr=true                       # 错误日志重定向到标准输出

# 错误日志也可单独配置双输出（可选）
stderr_logfile=/var/log/django_stderr.log  # 错误日志文件
stderr_logfile_maxbytes=50MB
stderr_logfile_backups=3
stderr_logfile=/dev/stderr                 # 同时输出到控制台